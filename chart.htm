<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>Shed humidity</title>
		
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script type="text/javascript" src="http://code.highcharts.com/highcharts.js"></script>
		
<script type="text/javascript">

var options;
var humidity;
var temp;
var chart;
	
function prep_graph(){
	options = {
		chart: {
			renderTo: 'container',
			type: 'line',
			zoomType: 'xy'
		},
		title: {
			text: 'My Shed'
		},
		xAxis: {
			enabled: true,
			type: 'datetime',
			text: 'Time'
		},
		yAxis: [{
			title: {
				text: 'Rel Humidity'
			},
			labels: {
				format: '{value}%',
				style: {
					color: '#4572A7'
				}
			}
		},
		{
			title: {
				text: 'Temperature'
			},
			gridLineWidth: 0,
			labels: {
				format: '{value}Â°C',
				style: {
					color: '#89A54E'
				}
			},
			opposite: true
		}],
		legend: {
			layout: 'vertical',
			align: 'left',
			x: 60,
			verticalAlign: 'top',
			y: 40,
			floating: true,
			backgroundColor: '#FFFFFF'
		},
		series: []
	};
	chart = new Highcharts.Chart(options);
}

function load_data(data){	

		humidity = {
			name: 'Humidity',
			color: '#4572A7',
			data: []
		};
		temp = {
			name: 'Temperature',
			color: '#89A54E',
			data: []
		};

		// Split the lines
		var lines = data.split('\n');
		$.each(lines, function(lineNo, line) {
			var items = line.split(',');
			
			humidity.data.push([parseInt(items[0]), parseFloat(items[1])]);
			temp.data.push([parseInt(items[0]), parseFloat(items[2])]);
		});

	chart.addSeries(humidity);
	chart.addSeries(temp);

}

$(document).ready(function() {

prep_graph();
$.get('uploads/20131213.csv', load_data);

});
	
</script>
		
	</head>
	<body>
		
		<!-- 3. Add the container -->
		<div id="container" style="width: 800px; height: 400px; margin: 0 auto"></div>
		
				
	</body>
</html>
